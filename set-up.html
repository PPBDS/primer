<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Set Up for Working on PPBDS Projects – Preceptor’s Primer for Bayesian Data Science: Using the Cardinal Virtues for Inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ai.html" rel="next">
<link href="./07-election-1992.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7e5f63976465591361e97e8384fb2699.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./set-up.html">Set Up for Working on PPBDS Projects</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Preceptor’s Primer for Bayesian Data Science: Using the Cardinal Virtues for Inference</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/PPBDS/primer/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preamble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preamble</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Sampling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-rubin-causal-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Rubin Causal Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-cardinal-virtues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Cardinal Virtues</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-election-1992.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">1992 Election</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./set-up.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Set Up for Working on PPBDS Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AI</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#computer-set-up" id="toc-computer-set-up" class="nav-link active" data-scroll-target="#computer-set-up">Computer Set Up</a></li>
  <li><a href="#project-set-up" id="toc-project-set-up" class="nav-link" data-scroll-target="#project-set-up">Project Set Up</a></li>
  <li><a href="#daily-work" id="toc-daily-work" class="nav-link" data-scroll-target="#daily-work">Daily Work</a></li>
  <li><a href="#common-problems" id="toc-common-problems" class="nav-link" data-scroll-target="#common-problems">Common Problems</a></li>
  <li><a href="#style-guide" id="toc-style-guide" class="nav-link" data-scroll-target="#style-guide">Style Guide</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/PPBDS/primer/edit/main/set-up.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Set Up for Working on PPBDS Projects</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>This document provides a guide in setting up R/Positron/Git/GitHub to work on <em><a href="https://ppbds.github.io/primer/">The Primer</a></em>, both the book itself, <a href="https://github.com/PPBDS/primer">PPDBS/primer</a>, and the associated tutorials (<a href="https://github.com/PPBDS/primer.tutorials">PPDBS/primer.tutorials</a>) and data (<a href="https://github.com/PPBDS/primer.data">PPDBS/primer.data</a>) packages. The same procedures apply for working on other packages associated with the <a href="https://github.com/PPBDS/">PPBDS</a> organization: <a href="https://github.com/PPBDS/tutorial.helpers">PPDBS/tutorial.helpers</a>, <a href="https://github.com/PPBDS/positron.tutorials">PPDBS/positron.tutorials</a>, <a href="https://github.com/PPBDS/r4ds.tutorials">PPDBS/r4ds.tutorials</a>, <a href="https://github.com/PPBDS/tidycensus.tutorials">PPDBS/tidycensus.tutorials</a>, <a href="https://github.com/PPBDS/tidymodels.tutorials">PPDBS/tidymodels.tutorials</a> and others. There are three steps:</p>
<ul>
<li><p>The first part ensures that you have the knowledge and computer settings to be successful. With luck, you will only need to do this once. At the very least, you should upgrade your R version to the latest available and re-do the set up commands as specified in the <a href="https://ppbds.github.io/primer/getting-started.html">Getting Started</a> chapter.</p></li>
<li><p>The second part involves making a connection between the true repos at the <a href="https://github.com/PPBDS/">PPBDS Github organization</a> and your Github account and your computer. You may end up doing this dozens of times since, whenever something gets messed up, the easiest solution is often to just <a href="https://www.urbandictionary.com/define.php?term=nuke%20it%20from%20orbit">nuke it from orbit</a> and start again. But, most weeks, you won’t do this at all.</p></li>
<li><p>The third part involves the daily workflow of merges and pull requests. You will do these steps many times each day.</p></li>
<li><p><strong>Never forget</strong>: Do not put any work in Windows OneDrive or any other cloud-hosted directory. This can cause endless problems. Moreover, you don’t need this sort of back-up service since your work will be saved on GitHub.</p></li>
</ul>
<p>The <em>test</em> which ensures that you have successfully completed this set up is to submit a PR for the <code>TODO.txt</code> file in the PPBDS package (which you are working on) which adds your name at the very bottom of the file. The <code>TODO.txt</code> file is always located at the top of the directory structure. The PR should only change that file. If you are working on a tutorial package, you should also read about <a href="https://ppbds.github.io/tutorial.helpers/articles/instructions.html">how to write tutorials</a>, especially tutorials <a href="https://ppbds.github.io/tutorial.helpers/articles/books.html">based on books</a>.</p>
<section id="computer-set-up" class="level2"><h2 class="anchored" data-anchor-id="computer-set-up">Computer Set Up</h2>
<ol type="1">
<li><p>Read the <a href="https://ppbds.github.io/primer/getting-started.html">Getting Started</a> chapter from <a href="https://ppbds.github.io/primer/">The Primer</a>. Complete at least the first four tutorials in the <strong>positron.tutorials</strong> package. The best reference for R/Git/Github issues is always <a href="https://happygitwithr.com/"><em>Happy Git and GitHub for the useR</em></a>.</p></li>
<li><p>Make sure that your Git/Github connections are good. If you have gone through the key chapters in <a href="https://happygitwithr.com/">Happy Git with R</a> — as you should have — then these may already be OK. If not (or, even if you have), then you need to run <code>usethis::git_sitrep()</code>.</p></li>
</ol>
<pre><code>&gt; library(usethis)   
&gt; git_sitrep()    
Git config (global)   
● Name: 'David Kane'   
● Email: 'dave.kane@gmail.com'   
● Vaccinated: FALSE   
ℹ See `?git_vaccinate` to learn more   
ℹ Defaulting to https Git protocol   
● Default Git protocol: 'https'   
GitHub   
● Default GitHub host: 'https://github.com'   
● Personal access token for 'https://github.com': '&lt;discovered&gt;'   
● GitHub user: 'davidkane9'   
● Token scopes: 'delete_repo, gist, notifications, repo, user, workflow'   
● Email(s): 'dave.kane@gmail.com (primary)', 'dkane@fas.harvard.edu'   
...   </code></pre>
<p>I left out the end of the output.</p>
<p>If the first part — Git config — seems messed up, execute (with your information):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">use_git_config</span><span class="op">(</span>user.name <span class="op">=</span> <span class="st">"davidkane9"</span>, user.email <span class="op">=</span> <span class="st">"dave.kane@gmail.com"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>If the second part seems messed up, try:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu">create_github_token</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>and read about <a href="https://usethis.r-lib.org/articles/articles/git-credentials.html">Github credentials</a>. After you do, restart R and then run <code>git_sitrep()</code> again to make sure that things look like mine, more or less.</p>
<ol start="3" type="1">
<li>Install the <a href="https://rstudio.github.io/renv/"><strong>renv</strong></a> package. Read about the <strong>renv</strong> package <a href="https://rstudio.github.io/renv/articles/renv.html">here</a>. Most of the PPBDS projects use <strong>renv</strong>. The most important exception is <strong>primer</strong>, which uses a DESCRIPTION file to keep track of the required R packages.</li>
</ol>
<p>It is not critical to understand all the details of how <strong>renv</strong> works. The big picture is that it creates a set of libraries which will be used just for this project and whose versions are kept in sync between you and me.</p>
<ol start="4" type="1">
<li>At this point, you should have all the tools you need to contribute. If you have never done a pull request, however, you will need to learn more. Start by reading the <a href="https://usethis.r-lib.org/articles/articles/pr-functions.html">help page</a>. Read the whole thing! Don’t just skim it. These are important concepts for professional-level workflow. The <strong>usethis</strong> package is mostly providing wrappers around the underlying git commands. If you want to understand what is happening at a lower level, read <a href="https://git-scm.com/book/en/v2/GitHub-Contributing-to-a-Project">this</a>, but doing so is optional.</li>
</ol>
<p>Again, with luck, you will only have to do these steps once.</p>
<ol start="5" type="1">
<li>Prove to yourself (and to me) that your set up is working by submitting a pull request to me which simply adds your name to the top of the <code>TODO.txt</code> file in whichever PPBDS project you are working. (See below for how to do this.) Email me to set up our next meeting after you do this.</li>
</ol></section><section id="project-set-up" class="level2"><h2 class="anchored" data-anchor-id="project-set-up">Project Set Up</h2>
<p>You will need to do the below steps at least one time. It is more likely, however, that you will do them dozens of times. If things are working, great! If they start not working, you can try to diagnose the problem. But, if you can’t, then you are in a <a href="https://knowyourmeme.com/memes/nuke-it-from-orbit">nuke it from orbit</a> scenario, which means that you start by deleting the current version of the package from two places: your computer and your Github account. To delete a project from your computer, put the R Studio project directory in the Trash. Make sure to also close out of the R Studio session after you delete it. If for some reason you cannot completely remove it, consider using the command <code>$sudo rm -r dirname</code> where you replace <code>dirname</code> with the path to the project on your computer. <code>sudo</code> and <code>rm</code> can be extremely dangerous when used together, so make sure to double check the command and/or do additional research. After you successfully remove the R project from your computer, go to your Github account and then go to Settings to delete the repo.</p>
<p>Key steps:</p>
<ol type="1">
<li>Fork/download the target repo:</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org">usethis</a></span><span class="op">)</span>  </span>
<span><span class="fu">create_from_github</span><span class="op">(</span>repo_spec <span class="op">=</span> <span class="st">"PPBDS/INSERT-NAME-OF-PROJECT"</span>,   </span>
<span>                   fork <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                   rstudio <span class="op">=</span> <span class="cn">FALSE</span>,   </span>
<span>                   destdir <span class="op">=</span> <span class="st">"/Users/davidkane/Desktop/projects/"</span>,   </span>
<span>                   protocol <span class="op">=</span> <span class="st">"https"</span><span class="op">)</span>  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Obviously, you need to modify the string “INSERT-NAME-OF-PROJECT” to correspond to one of our projects. Most common options are <strong>positron.tutorials</strong>, <strong>primer</strong>, <strong>primer.data</strong>, and <strong>primer.tutorials</strong>. If, for some reason, you are working on a project which does not reside in the PPBDS organization, you should modify the first part of the <code>repo_spec</code> as well.</p>
<p>You must change <code>destdir</code> to be a location on your computer. Indeed, professionals will generally have several different Positron windows open, each working on a different project, each of which is connected to its own Github repo.</p>
<p>For your education, it is worth reading the help page for <code>create_from_github()</code>. The <code>fork</code> and <code>protocal</code> arguments may not really be necessary and, obviously, you should place the project in the location on your computer in which your other projects live. The command first forks a copy of <strong>PPBDS/primer</strong> to your Github account and then clone/downloads that fork to your computer.</p>
<p>This may seem like overkill, but, as <a href="https://git-scm.com/book/en/v2"><em>Pro Git</em></a> explains, it is how (essentially) all large projects are organized. With luck, you only have to issue this command once. After that, you are always connected, both to your fork and to the true repos, which live at github/com/PPBDS. Also, note that, if something ever gets totally messed up on your computer, you can just delete the project folder on your computer and the repo on your Github account and then start again. (If you have made changes that you don’t want to lose, just save the files with those changes to one side and then move them back after you have recreated the project.)</p>
<p>Note that this command should automatically put you in a new Positron session within the <code>primer</code> (or <code>primer.tutorials</code> or <code>primer.data</code>) project which now resides on your computer.</p>
<!-- DK: The above description is left over from RStudio. Is that what happens in Positron? -->
<ol start="2" type="1">
<li>The next step is to get <strong>renv</strong> setup so that you are running the same package versions as everyone else. Run this once:</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/renv/">renv</a></span><span class="op">)</span></span>
<span><span class="fu">renv</span><span class="fu">::</span><span class="fu">restore</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This will install all the packages you need in the directory of this project. If this command fails, most commonly with a report about problems with compiling a specific package, notify me right away. If I update the <code>renv.lock</code> file by using <code>renv::update()</code>, the problem will often go away. See the Common Problems section below for further discussion.</p>
<p><code>renv::restore()</code> has no effect on your main library of R packages. Restart your R session. Again, this means that you now have two separate installations of, for example, <code>ggplot2</code>. One is in the default place which your R sessions is by default pointed to. (In a different project without a <code>renv</code> directory, you can run <code><a href="https://rdrr.io/r/base/libPaths.html">.libPaths()</a></code> to see where that is.) The second place that <code>ggplot2</code> is installed is in the <code>renv</code> directory associated with this project.</p>
<p>Note that, for the most part, you won’t do anything with <strong>renv</strong> after this initial use. If you use error = TRUE in any code chunk, you will also need <code>renv.ignore = TRUE</code> in that code chunk, or you will get an annoying warning because renv can’t parse the code in that chunk.</p>
<p>However, there are three other <strong>renv</strong> commands you might issue:</p>
<p><code>renv::status()</code> just reports if anything is messed up. It won’t hurt anything.</p>
<p><code>renv::restore()</code> looks at the <code>renv.lock</code> file and installs the packages it specifies. You will need to do this when I make a change to <code>renv.lock</code>, e.g., if I upgrade our version of <strong>ggplot2</strong> or add a new package.</p>
<p><code>renv::snapshot()</code> should only be issued if you know what you are doing. This changes the <code>renv.lock</code> file, which is something that, usually, only I do. Most common case for use would be if you need to add a new package to the project.</p>
<p><strong>Warning:</strong> The <strong>renv</strong> package commands are very sensitive to your current working directory. Ensure that you are in the main directory of your project — something like <code>/Users/dkane/Desktop/projects/primer.tutorials</code> — before you run any of them.</p>
<ol start="3" type="1">
<li>Create a branch to work from:</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pr_init</span><span class="op">(</span>branch <span class="op">=</span> <span class="st">"chapter-9"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Make sure the branch name is sensible. Again, this is a command that you only need to issue once, at least for our current workflow. You should always be “on” this branch, never on the default (master) branch. You can check this in the upper right corner of the git panel on R Studio.</p>
<p>In more professional settings, you will often work on several different branches at once. So, if you are comfortable, you should feel free to create more than one branch, use it, delete it and so on. Never work on the default branch, however. And, if you use multiple branches, be careful where you are and what you are doing.</p>
</section><section id="daily-work" class="level2"><h2 class="anchored" data-anchor-id="daily-work">Daily Work</h2>
<ol start="0" type="1">
<li><p>Always use the “Source” view — not the “Visual” view — in Positron to edit. The Visual view will often reformat your code, without you asking, in unhelpful ways. You don’t want Positron to make changes in your code.</p></li>
<li><p>Pull regularly:</p></li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pr_merge_main</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Issue this command all the time. This is how you make sure that your repo and your computer is updated with the latest changes that have been made in the book. The word “upstream” is associated with the repos at PPBDS. The word “origin” is associated with the fork at your Github account. But, in general, you don’t need to worry about this. Just pull every time you sit down. (Just clicking the pull button is not enough. That only pulls from your repo, to which no changes have been made. It does not pull from <strong>PPBDS/primer</strong>, et al.) You issue this command multiple times a day.</p>
<ol start="2" type="1">
<li>Make changes in the file you are editing. Knit to make sure the changes work. Commit with a message. Push to the repo on your Github account. And so on.</li>
</ol>
<p>At some point, you will be ready to push to the PPBDS organization. However, you can’t do this directly. Instead, you must submit a pull request (PR). Because you are part of a larger project, these commands are slightly different than what you have done before.</p>
<ol start="3" type="1">
<li>Issue pull requests every few days, depending on how much work you have done and/or whether other people are waiting for something you have done.</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pr_push</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This command bundles up a bunch of git commands (which you could do by hand) into one handy step. This command does everything needed to create a “pull request” — a request from you to me that I accept the changes you are proposing into the repo at <strong>PPBDS/primer</strong> — and then opens up the web page to show you. <strong>But you are not done!</strong> You must PRESS the green button on that web page, sometimes twice. Until then, the PR has not actually been created. <code>pr_push()</code> just does everything before that. The “pr” in <code>pr_push()</code> stands for pull request.</p>
<ol start="4" type="1">
<li><p>I will leave aside for now issues associated with the back-and-forth discussions we might have around your pull request. I will probably just accept it. Your changes will go into the repos at PPBDS and then be distributed to everyone else when they run <code>pr_merge_main()</code>.</p></li>
<li><p>You can now continue on. There is no need to wait for me to deal with your pull request. There is no need to fork/clone/download again. You don’t need to create a new branch, although many people do, with a branch name which describes what they are working on now. You just keep editing your files, knitting, and committing then pushing to your forked repo. When you feel you have completed another chunk of work, just run <code>pr_push()</code> again.</p></li>
<li><p>Read the <strong>usethis</strong> <a href="https://usethis.r-lib.org/articles/articles/usethis-setup">setup help page</a> at least once, perhaps after a week or two of working within this framework. It has lots of good stuff!</p></li>
</ol></section><section id="common-problems" class="level2"><h2 class="anchored" data-anchor-id="common-problems">Common Problems</h2>
<!-- DK: And 1) and 2) still problems? -->
<!-- TM: Make sure RTools has been downloaded if error with downloading terra after running renv::restore() in setup -->
<ol type="1">
<li><p>In the immediate aftermath of this creation process, the blue/green arrows (in the Git panel) for pulling/pushing may be grayed out. This is a sign that the connection between your computer and your forked repo has not “settled in.” (I am not sure of the cause or even if this is the right terminology.) I think that just issuing your first <code>pr_merge_main()</code> fixes it. If not, it always goes away. Until it does, however, you can’t pull/push to your repo. That doesn’t really matter, however, since the key commands you need are <code>pr_merge_main()</code> and <code>pr_push()</code>, both of which always work immediately.</p></li>
<li><p>After running <code>pr_merge_main()</code>, <em>you will often see a bunch of files, in your Source Control pane, marked with an M (for Modified), including files which you know you did not edit. These are the files that have been updated on the “truth” — on <strong>PPBDS/primer</strong>, for example — since your last <code>pr_merge_main()</code>. Since you pulled them directly from the <strong>PPBDS/primer</strong> repo, your forked repo sees all the changes other people have made and thinks that </em>you made them*. This is easily fixed, however — just commit all the changes to your forked repo. (Strangely, this seems to not always happen. If you don’t see this effect, don’t worry.)</p></li>
<li><p>Always run <code>pr_merge_main()</code> before committing a file. Otherwise, you may create lots of merge conflicts. If this happens, save a copy of the file(s) you personally were editing off to the side. Then, <a href="https://knowyourmeme.com/memes/nuke-it-from-orbit">nuke it from orbit</a>, following the instructions above. Repeat the Project Set Up process. Then move in your file(s) by hand into the new repo, and commit/push them as normal.</p></li>
<li><p>When you submit a pull request to merge your work with the PPBDS repo, it won’t always be smiles and sunshine — every once in a while, you’ll run into <em>merge conflicts</em>. When these arise, it is because two parties work on a file separately and submit conflicting changes. This makes it hard for GitHub to “merge” your version with the other version. When this happens, find multiple adjacent “&gt;”, “&lt;”, and “=” signs in your document — these will show you where the conflicts occur. For more background on merge conflicts, read <a href="https://docs.gitlab.com/ee/user/project/merge_requests/conflicts.html">this</a>.</p></li>
</ol>
<p>If you see the above-mentioned conflicts in your document, <strong>do not submit a pull request</strong>. This will mess things up. Instead, first, go through your document, and make sure all the weird conflict indicators (&lt;, &gt;, and =) are removed. Second, decide what goes in that space. It might be the stuff you wrote. It might be the other stuff. It might be some combination of the two which you decide on. Whatever happens, you are making an affirmative choice about what should appear in the file at that location. Once all the merge conflicts are fixed, run <code>pr_push()</code> again.</p>
<ol start="5" type="1">
<li>
<code>pr_push()</code> can be tricky. First, note that, if I have not accepted a (<strong>p</strong>)ull (<strong>r</strong>)equest which you have submitted, then your PR is still open. You can see it <a href="https://github.com/PPBDS/primer/pulls">on Github</a>. In fact, you can see all the closed/completed pull requests as well. If, while one PR is still open, you submit another <code>pr_push()</code>, then this will just be added to your current PR. And that is OK! We don’t need it to be separate.</li>
</ol>
<p>But even if there is not an open PR, <code>pr_push()</code> can be tricky. The key thing to remember is that <em>you must press a green button on Github</em> for a new PR to be created. Normally, this is easy. Running <code>pr_push()</code> automatically (or perhaps after you run <code>pr_view()</code>) puts you in a browser and brings you to the correct Github page. Press the button and – presto! – you have created a PR. But, sometimes, the web page is different. It actually sends you back to an old pull request. When this happens, you need to click on the “Pull Request” tab above. This will take you to a new page, with a green button labeled “Compare &amp; Pull Request”. Press that button.</p>
<ol start="6" type="1">
<li><p>If you end up needing to install a new package — which should be rare — just install it with <code>renv::install()</code>and then type <code>renv::status()</code> to confirm than <strong>renv</strong> is aware of the change. Then, type <code>renv::snapshot()</code>. This will update the <code>renv.lock</code> file to include the new package. You just commit/push the new version of <code>renv.lock</code>, and that shares the information with everyone else on the project. Never commit/push a modified <code>renv.lock</code> unless you know why it has changed. But, for the most part, leave changes in <code>renv.lock</code> to me.</p></li>
<li><p>Be careful of committing garbage files like “.DS_Store”, which is a file created sometimes. Only commit changes which you understand. In the vast majority of cases your PRs will only involve one or two files.</p></li>
<li><p>If using Windows, make sure you have RTools installed.</p></li>
<li><p>Sometimes, your <strong>renv</strong> library becomes messed up. Note that nuking from orbit may not fix this because <strong>renv</strong> installs your packages in some private common area which is not impacted when you reinstall the PPBDS package you are working with. In this case, running <code>renv::rebuild()</code> may help. If not, run <code>renv::diagnostics()</code>, find the path to the <strong>renv</strong> cache directory and delete everything there by hand. Then, run <code>renv::repair()'.</code></p></li>
<li><p>When using <code>renv::restore()</code>, you will occasionally have a problem in which one package, say <strong>aprob</strong>, fails to install, thereby aborting the entire run. This can be tricky. The most common reason for this problem is that the <code>renv.lock</code> file specifies an older version of <strong>aprob</strong> than the current version available on CRAN. Since CRAN does not (?) keep binaries for non-current versions, your computer is forced to compile from source. This often works OK, especially if you are using a Mac. But it often doesn’t work. The easiest approach is to update the <code>renv.lock</code> file to use the latest version of <strong>aprob</strong>.</p></li>
</ol>
<p>Complications can also arise if <strong>aprob</strong> was, in the last day or two, updated on CRAN. If you go to the page for <strong>aprob</strong> you can see that the source file is version 1.2.7, or whatever, while the binary versions are still 1.2.6. It takes a day or two for new binaries to be created on CRAN, especially for Windows. Again, situations like this are tricky enough that you should reach out to me for guidance.</p>
</section><section id="style-guide" class="level2"><h2 class="anchored" data-anchor-id="style-guide">Style Guide</h2>
<ul>
<li><p>Section headings (other than Chapter titles) are in sentence case (with only the first word capitalized, unless it is something always capitalized) rather than title case (in which all words except small words like “the” and “of” are capitalized). Chapter titles are in title case. Headings do not end with a period.</p></li>
<li><p>Never hard code stuff like “A tibble with 336,776 rows and 19 columns.” What happens when you update the data? Instead, calculate all numbers on the fly, with “r scales::comma(x)” whenever x is a number in the thousands or greater. Example: “A tibble with ‘r scales::comma(nrow(x))’ rows and ‘r ncol(x)’ columns.”</p></li>
<li><p>“We” are writing this book.</p></li>
<li><p>Package names are in bold: <strong>ggplot2</strong> is a package for doing graphics. In general, we reserve bolding for package names. Use <em>italics</em> for emphasis in other contexts.</p></li>
<li><p>R code, anything you might type in the console, is always within backticks. Example: <code>mtcars</code> is a built-in data set.</p></li>
<li><p>Function names always include the parentheses: we write <code>pivot_wider()</code>, not <code>pivot_wider</code>.</p></li>
<li><p>Add lots of memes and videos and cartoons.</p></li>
<li><p>Make ample use of comments, placed with the handy <code>Command/Ctrl + Shift + /</code> shortcut. These are notes for everyone else working on the chapter, and for future you.</p></li>
<li><p>All tables should be created with the <strong>gt</strong> package.</p></li>
<li><p>All images and gifs are loaded with <code>knitr::include_graphics().</code></p></li>
<li><p>Interim data sets should be called <code>x</code> or something sensible to the situation, like <code>ch7</code> for a data set you are working with in Chapter 7. Do not use names like <code>data</code> and <code>df</code>, both of which are R commands.</p></li>
<li><p>Students are sometimes tentative. Don’t be! Edit aggressively. If you don’t like what is there, delete it. (If I disagree with your decision, I can always get the text back from Github.) Move things around. Make the chapter yours, while keeping to the style of the other chapters. Note that 90% of the prose here was not written by me. Cut anything you don’t like.</p></li>
<li><p>If you make an mp4, you can convert it to .gif using https://convertio.co/mp4-gif.</p></li>
<li><p>Everything is Bayesian. The confidence interval for a regression means that there is a 95% chance that the true value lies within that interval. Use Rubin Causal Model and potential outcomes to define precisely what “true value” you are talking about. And so on.</p></li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./07-election-1992.html" class="pagination-link" aria-label="1992 Election">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">1992 Election</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ai.html" class="pagination-link" aria-label="AI">
        <span class="nav-page-text">AI</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/PPBDS/primer/edit/main/set-up.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>